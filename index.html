<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prueba Video GLB Simple</title>

<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

<style>
body { margin:0; background:#000; display:flex; flex-direction:column; align-items:center; justify-content:center; height:100vh; }
model-viewer { width:90vw; height:80vh; background:#000; }
button { margin-top:20px; padding:10px 20px; font-size:16px; cursor:pointer; }
</style>
</head>
<body>

<video id="video" src="dama.mp4" loop muted playsinline crossorigin="anonymous" style="display:none"></video>

<model-viewer id="viewer" src="pantalla.glb" camera-controls shadow-intensity="1"></model-viewer>

<button id="applyVideo">Aplicar Video</button>

<script>
const viewer = document.getElementById("viewer");
const video = document.getElementById("video");
const button = document.getElementById("applyVideo");

button.addEventListener("click", async () => {
  try {
    console.log("Botón presionado");

    // Asegúrate que el video se pueda reproducir
    video.muted = true;
    await video.play();

    // Crear textura
    const texture = await viewer.createTexture(video);

    // Buscar el material correcto
    const material = viewer.model.materials.find(mat => mat.name === "Material.006");
    if (!material) {
      console.error("No se encontró 'Material.006'");
      return;
    }

    material.pbrMetallicRoughness.setBaseColorTexture(texture);
    material.pbrMetallicRoughness.setMetallicFactor(0);
    material.pbrMetallicRoughness.setRoughnessFactor(1);

    console.log("Video aplicado al plano correctamente");

  } catch(e) {
    console.error("Error:", e);
  }
});
</script>

</body>
</html>
