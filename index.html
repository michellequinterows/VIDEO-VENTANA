<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prueba Imagen en Plano AR</title>

<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

<style>
body { margin:0; background:#000; display:flex; justify-content:center; align-items:center; flex-direction:column; height:100vh; }
model-viewer { width:90vw; height:80vh; background:#000; }
button { margin-top:20px; padding:12px 25px; font-size:16px; cursor:pointer; border-radius:6px; border:none; background:#ff3d00; color:#fff; }
button:hover { background:#ff5722; }
</style>
</head>
<body>

<!-- Modelo GLB con AR habilitado -->
<model-viewer id="viewer"
  src="pantalla.glb"
  ar
  ar-modes="scene-viewer quick-look webxr"
  camera-controls
  shadow-intensity="1"
  exposure="1">
</model-viewer>

<button id="applyImage">Aplicar Imagen en Plano</button>

<script>
const viewer = document.getElementById("viewer");
const button = document.getElementById("applyImage");

button.addEventListener("click", async () => {
  try {
    // Crear objeto imagen
    const img = new Image();
    img.src = "damaimg.png"; // tu imagen de prueba
    img.crossOrigin = "anonymous";

    img.onload = async () => {
      // Crear textura desde la imagen
      const texture = await viewer.createTexture(img);

      // Buscar el material del plano
      const material = viewer.model.materials.find(mat => mat.name === "Material.006");

      if (!material) {
        console.error("No se encontr√≥ 'Material.006'");
        return;
      }

      // Aplicar la textura de imagen
      material.pbrMetallicRoughness.setBaseColorTexture(texture);
      material.pbrMetallicRoughness.setMetallicFactor(0);
      material.pbrMetallicRoughness.setRoughnessFactor(1);

      console.log("Imagen aplicada correctamente al plano.");
    }

  } catch (e) {
    console.error("Error aplicando la imagen:", e);
  }
});
</script>

</body>
</html>
